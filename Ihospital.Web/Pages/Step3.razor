@page "/step3"
@using Ihospital.Web.Services
@inject NavigationManager Navigation
@inject ISurveyStateService SurveyState

<PageTitle>Survey Platform - Step 3</PageTitle>

<div class="survey-container">
    <div class="survey-header">
        <h1>Survey Platform</h1>
    </div>

    <div class="survey-content">
        <h2 class="survey-title">Patient Feedback Survey – Step 3</h2>
        <p class="survey-subtitle">Tell us about your hospital stay</p>

        <div class="survey-form">
            <div class="form-group">
                <label>Room Type</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="roomType" value="Public Standard Room" @onchange="@(() => roomType = "Public Standard Room")" checked="@(roomType == "Public Standard Room")" />
                        <span>Public Standard Room</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="roomType" value="Public Cluster Room" @onchange="@(() => roomType = "Public Cluster Room")" checked="@(roomType == "Public Cluster Room")" />
                        <span>Public Cluster Room</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="roomType" value="Public Single Room" @onchange="@(() => roomType = "Public Single Room")" checked="@(roomType == "Public Single Room")" />
                        <span>Public Single Room</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="roomType" value="Private Single Room" @onchange="@(() => roomType = "Private Single Room")" checked="@(roomType == "Private Single Room")" />
                        <span>Private Single Room</span>
                    </label>
                </div>
            </div>

            @* Show Stay Period if Private Single or Public Single selected *@
            @if (roomType == "Private Single Room" || roomType == "Public Single Room")
            {
                <div class="form-group">
                    <label>How long was your stay?</label>
                    <select class="form-select" @bind="stayPeriod">
                        <option value="">Select stay period</option>
                        <option value="1 day">1 day</option>
                        <option value="2-3 days">2-3 days</option>
                        <option value="4-7 days">4-7 days</option>
                        <option value="More than 1 week">More than 1 week</option>
                    </select>
                </div>
            }
        </div>

        <div class="form-actions">
            <button class="btn-secondary" @onclick="GoBack"><span>←</span> Back</button>
            <button class="btn-primary" @onclick="NextStep">Next <span>→</span></button>
        </div>
    </div>
</div>

@code {
    private string roomType = "Public Standard Room";
    private string stayPeriod = "";

    protected override void OnInitialized()
    {
        if (!string.IsNullOrEmpty(SurveyState.RoomType))
        {
            roomType = SurveyState.RoomType;
        }
        if (!string.IsNullOrEmpty(SurveyState.StayPeriod))
        {
            stayPeriod = SurveyState.StayPeriod;
        }
    }

    private void NextStep()
    {
        SurveyState.RoomType = roomType;
        SurveyState.StayPeriod = stayPeriod;
        Navigation.NavigateTo("/step4");
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/step2");
    }
}
